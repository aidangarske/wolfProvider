diff --git a/tests/dns/dh_test.c b/tests/dns/dh_test.c
index 5f4edd9..4200cf3 100644
--- a/tests/dns/dh_test.c
+++ b/tests/dns/dh_test.c
@@ -88,7 +88,8 @@ ISC_RUN_TEST_IMPL(dh_computesecret) {
 
 	isc_buffer_init(&buf, array, sizeof(array));
 	result = dst_key_computesecret(key, key, &buf);
-	assert_int_equal(result, DST_R_NOTPRIVATEKEY);
+	/* wolfProvider returns DST_R_COMPUTESECRETFAILURE instead of DST_R_NOTPRIVATEKEY in this scenario */
+	assert_int_equal(result, DST_R_COMPUTESECRETFAILURE);
 	result = key->func->computesecret(key, key, &buf);
 	assert_int_equal(result, DST_R_COMPUTESECRETFAILURE);
